<?xml version="1.0" encoding="utf-8"?>
<fx:Object xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:mx="library://ns.adobe.com/flex/halo" xmlns:business="com.asfusion.mate.stockQuoteExample.business.*" xmlns:service="stocks.service.*" xmlns:glue="http://glue.seanhess.net/2009">

	<fx:Declarations>
		<glue:Respond id="respondQuote" result="onResult(event.source)" fault="onFault(event)"/>
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import stocks.service.IQuoteService;
			import stocks.service.QuoteServiceParser;
			import mx.rpc.AbstractOperation;
			import mx.controls.Alert;
			import mx.rpc.events.ResultEvent;
			import stocks.model.Quote;
			
			[Bindable]
			private var quote:Quote;
			
			public var quoteService:IQuoteService;
			public var parser:QuoteServiceParser; // not an interface, but you could extend it to mock it
			
			public function getQuote(quote:Quote):void
			{
				this.quote = quote;
				respondQuote.start(quoteService);
				quoteService.getQuote(quote.symbol);
			}
			
			private function onResult(event:ResultEvent):void
			{
				quote.price = parser.getPrice(event.result);
			}
			
			private function onFault(event:Event):void
			{
				Alert.show("There was an error");
			}
		]]>
	</fx:Script>
</fx:Object>
